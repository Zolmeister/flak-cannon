(function() {
  var ConversionState, ConversionStore, ExperimentState, ExperimentStore, QueryBuilder, QueryView, RecoilController, RecoilView, ResultStore, ShowState, SparkLine, isPSignificant, nMinusOneChiSquare, pFromZ;

  SparkLine = function(data) {
    var sparkline;
    sparkline = function($el, isInit) {
      var graph, palette;
      if (isInit) {
        return;
      }
      palette = new Rickshaw.Color.Palette();
      graph = new Rickshaw.Graph({
        element: $el,
        width: 100,
        height: 50,
        renderer: 'line',
        series: [
          {
            data: _.map(data, function(datum, i) {
              return {
                x: i,
                y: datum.count
              };
            }),
            color: palette.color()
          }
        ]
      });
      return graph.render();
    };
    return m('div.sparkline', {
      config: sparkline
    });
  };

  nMinusOneChiSquare = function(aConversions, aTotal, bConversions, bTotal) {
    var N, a, b, c, chi2, d, m, n, r, s, z;
    a = aConversions;
    b = aTotal - aConversions;
    c = bConversions;
    d = bTotal - bConversions;
    r = a + c;
    s = b + d;
    m = a + b;
    n = c + d;
    N = m + n + r + s;
    chi2 = Math.pow(a * d - b * c, 2) * (N - 1) / (m * n * r * s);
    z = Math.sqrt(Math.abs(chi2));
    return 1 - pFromZ(z);
  };

  pFromZ = function(z) {
    var Z_MAX, w, x, y;
    Z_MAX = 6.0;
    if (z === 0.0) {
      x = 0.0;
    } else {
      y = 0.5 * Math.abs(z);
      if (y > (Z_MAX * 0.5)) {
        x = 1.0;
      } else if (y < 1.0) {
        w = y * y;
        x = ((((((((0.000124818987 * w - 0.001075204047) * w + 0.005198775019) * w - 0.019198292004) * w + 0.059054035642) * w - 0.151968751364) * w + 0.319152932694) * w - 0.531923007300) * w + 0.797884560593) * y * 2.0;
      } else {
        y -= 2.0;
        x = (((((((((((((-0.000045255659 * y + 0.000152529290) * y - 0.000019538132) * y - 0.000676904986) * y + 0.001390604284) * y - 0.000794620820) * y - 0.002034254874) * y + 0.006549791214) * y - 0.010557625006) * y + 0.011630447319) * y - 0.009279453341) * y + 0.005353579108) * y - 0.002141268741) * y + 0.000535310849) * y + 0.999936657524;
      }
    }
    if (z > 0.0) {
      return (x + 1.0) * 0.5;
    } else {
      return (1.0 - x) * 0.5;
    }
  };

  isPSignificant = function(p) {
    return p > 0.05;
  };

  ResultStore = (function() {
    var data, transform;
    transform = function(data) {
      var control;
      data = data.map(function(result) {
        result.totalConversions = _.reduce(result.data, function(sum, datum) {
          return sum + datum.count;
        }, 0);
        return result;
      });
      control = data[0];
      control.p = 0;
      control.percentDelta = 0;
      data = data.slice(1).map(function(result) {
        var aConversions, aPercent, aTotal, bConversions, bPercent, bTotal, p, percentDelta;
        aConversions = result.totalConversions;
        aTotal = result.participantCount;
        bConversions = control.totalConversions;
        bTotal = control.participantCount;
        aPercent = aConversions / aTotal;
        bPercent = bConversions / bTotal;
        percentDelta = aPercent - bPercent;
        p = nMinusOneChiSquare(aConversions, aTotal, bConversions, bTotal);
        result.p = p;
        result.percentDelta = percentDelta;
        return result;
      });
      data = [control].concat(_.sortBy(data, 'percentDelta').reverse());
      return data;
    };
    data = m.request({
      method: 'GET',
      url: '/api/fake/experiments/signupText/results?\nfrom=1/1/14&to=1/30/14&split=Platform,Browser&conversion=signUp'
    });
    return {
      getAll: function() {
        return data.then(transform);
      },
      query: function(q) {
        q = _.defaults(q, {
          experiment: '',
          start: '',
          end: '',
          splits: '',
          conversion: '',
          namespace: ''
        });
        return m.request({
          method: 'GET',
          url: "/api/" + q.namespace + "/experiments/" + q.experiment + "/results\n?from=" + (moment(q.start).format('L')) + "\n&to=" + (moment(q.end).format('L')) + "\n&split=" + q.splits + "\n&conversion=" + q.conversion
        }).then(transform).then(data);
      }
    };
  })();

  QueryBuilder = function(queryHandler) {
    var conversion, end, experiment, namespace, query, splits, start;
    experiment = m.prop('signupText');
    start = m.prop(moment().subtract('days', 14).format('L').toString());
    end = m.prop(moment().format('L').toString());
    splits = m.prop('');
    conversion = m.prop('signUp');
    namespace = m.prop('');
    query = function() {
      return queryHandler({
        experiment: experiment(),
        start: start(),
        end: end(),
        splits: splits(),
        conversion: conversion(),
        namespace: namespace()
      });
    };
    return function() {
      return m('div', [
        m('input', {
          value: namespace(),
          placeholder: 'namespace',
          onchange: m.withAttr('value', namespace)
        }), m('input', {
          value: experiment(),
          placeholder: 'experiment',
          onchange: m.withAttr('value', experiment)
        }), m('input', {
          value: start(),
          placeholder: 'start',
          onchange: m.withAttr('value', start)
        }), m('input', {
          value: end(),
          placeholder: 'end',
          onchange: m.withAttr('value', end)
        }), m('input', {
          value: splits(),
          placeholder: 'splits (, separated)',
          onchange: m.withAttr('value', splits)
        }), m('input', {
          value: conversion(),
          placeholder: 'conversion',
          onchange: m.withAttr('value', conversion)
        }), m('button', {
          onclick: query
        }, 'go')
      ]);
    };
  };

  ExperimentStore = (function() {
    var data;
    data = m.request({
      method: 'GET',
      url: '/api/fake/experiments'
    });
    return {
      getAll: function() {
        return data;
      }
    };
  })();

  ConversionStore = (function() {
    var data;
    data = m.request({
      method: 'GET',
      url: '/api/fake/conversions/uniq'
    });
    return {
      getAll: function() {
        return data;
      }
    };
  })();

  ExperimentState = function(experiments) {
    return m('ul', experiments.map(function(experiment) {
      return m('li', [
        experiment.name, m('ul', experiment.values.map(function(val) {
          return m('li', val);
        }))
      ]);
    }));
  };

  ConversionState = function(conversions) {
    return m('ul', conversions.map(function(conversion) {
      return m('li', conversion.name);
    }));
  };

  ShowState = function(experiments, conversions) {
    return ['Experiments', ExperimentState(experiments), 'Conversions', ConversionState(conversions)];
  };

  RecoilController = function() {
    return {
      results: ResultStore.getAll(),
      experiments: ExperimentStore.getAll(),
      conversions: ConversionStore.getAll()
    };
  };

  QueryView = QueryBuilder(ResultStore.query);

  RecoilView = function(ctrl) {
    var percent, titles;
    titles = ['test', 'sparkline'].concat(ctrl.results()[0] ? _.keys(ctrl.results()[0].splits) : void 0).concat(['conversions', 'participants', 'percent', 'p < 0.05', 'delta']);
    percent = function(n) {
      return (n * 100).toFixed(2) + '%';
    };
    return [
      ShowState(ctrl.experiments(), ctrl.conversions()), m('br'), QueryView(), m('br'), m('table', titles.map(m.bind(m, 'th')).concat(_.map(_.values(ctrl.results()), function(result) {
        var color;
        color = result.percentDelta > 0 ? 'green' : result.percentDelta === 0 ? 'black' : 'red';
        return m('tr', [m('td', result.test), m('td', [SparkLine(result.data)])].concat(_.map(_.values(result.splits), m.bind(m, 'td'))).concat([
          m('td', result.totalConversions), m('td', result.participantCount), m('td', percent(result.totalConversions / result.participantCount)), m('td', result.p.toFixed(3)), m('td', {
            style: {
              color: color
            }
          }, percent(result.percentDelta))
        ]));
      })))
    ];
  };

  m.module(document.getElementById('recoil'), {
    controller: RecoilController,
    view: RecoilView
  });

}).call(this);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXMiOlsibWFpbi5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQSxNQUFBLHdNQUFBOztBQUFBLEVBQUEsU0FBQSxHQUFZLFNBQUMsSUFBRCxHQUFBO0FBQ1YsUUFBQSxTQUFBO0FBQUEsSUFBQSxTQUFBLEdBQVksU0FBQyxHQUFELEVBQU0sTUFBTixHQUFBO0FBQ1YsVUFBQSxjQUFBO0FBQUEsTUFBQSxJQUFHLE1BQUg7QUFDRSxjQUFBLENBREY7T0FBQTtBQUFBLE1BR0EsT0FBQSxHQUFjLElBQUEsUUFBUSxDQUFDLEtBQUssQ0FBQyxPQUFmLENBQUEsQ0FIZCxDQUFBO0FBQUEsTUFJQSxLQUFBLEdBQVksSUFBQSxRQUFRLENBQUMsS0FBVCxDQUNWO0FBQUEsUUFBQSxPQUFBLEVBQVMsR0FBVDtBQUFBLFFBQ0EsS0FBQSxFQUFPLEdBRFA7QUFBQSxRQUVBLE1BQUEsRUFBUSxFQUZSO0FBQUEsUUFHQSxRQUFBLEVBQVUsTUFIVjtBQUFBLFFBSUEsTUFBQSxFQUFRO1VBQ047QUFBQSxZQUFBLElBQUEsRUFBTSxDQUFDLENBQUMsR0FBRixDQUFNLElBQU4sRUFBWSxTQUFDLEtBQUQsRUFBUSxDQUFSLEdBQUE7cUJBQ2hCO0FBQUEsZ0JBQUEsQ0FBQSxFQUFHLENBQUg7QUFBQSxnQkFDQSxDQUFBLEVBQUcsS0FBSyxDQUFDLEtBRFQ7Z0JBRGdCO1lBQUEsQ0FBWixDQUFOO0FBQUEsWUFJQSxLQUFBLEVBQU8sT0FBTyxDQUFDLEtBQVIsQ0FBQSxDQUpQO1dBRE07U0FKUjtPQURVLENBSlosQ0FBQTthQWlCQSxLQUFLLENBQUMsTUFBTixDQUFBLEVBbEJVO0lBQUEsQ0FBWixDQUFBO1dBb0JBLENBQUEsQ0FBRSxlQUFGLEVBQW1CO0FBQUEsTUFBQyxNQUFBLEVBQVEsU0FBVDtLQUFuQixFQXJCVTtFQUFBLENBQVosQ0FBQTs7QUFBQSxFQXdDQSxrQkFBQSxHQUFxQixTQUFDLFlBQUQsRUFBZSxNQUFmLEVBQXVCLFlB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QU0sQ0FBQyxnQkFBUCxHQUEwQixNQUFNLENBQUMsZ0JBQXpDLENBQVIsQ0FITSxFQUlOLENBQUEsQ0FBRSxJQUFGLEVBQVEsTUFBTSxDQUFDLENBQUMsQ0FBQyxPQUFULENBQWlCLENBQWpCLENBQVIsQ0FKTSxFQUtOLENBQUEsQ0FBRSxJQUFGLEVBQVE7QUFBQSxZQUFBLEtBQUEsRUFBTztBQUFBLGNBQUEsS0FBQSxFQUFPLEtBQVA7YUFBUDtXQUFSLEVBQTZCLE9BQUEsQ0FBUSxNQUFNLENBQUMsWUFBZixDQUE3QixDQUxNO1NBTE8sQ0FBUixDQUFQLENBSnNDO01BQUEsQ0FBaEMsQ0FERyxDQUFYLENBTEs7S0FBUCxDQVRXO0VBQUEsQ0FsUGIsQ0FBQTs7QUFBQSxFQW9SQSxDQUFDLENBQUMsTUFBRixDQUFTLFFBQVEsQ0FBQyxjQUFULENBQXdCLFFBQXhCLENBQVQsRUFDUTtBQUFBLElBQUMsVUFBQSxFQUFZLGdCQUFiO0FBQUEsSUFBK0IsSUFBQSxFQUFNLFVBQXJDO0dBRFIsQ0FwUkEsQ0FBQTtBQUFBIiwic291cmNlc0NvbnRlbnQiOlsiU3BhcmtMaW5lID0gKGRhdGEpIC0+XG4gIHNwYXJrbGluZSA9ICgkZWwsIGlzSW5pdCkgLT5cbiAgICBpZiBpc0luaXRcbiAgICAgIHJldHVyblxuXG4gICAgcGFsZXR0ZSA9IG5ldyBSaWNrc2hhdy5Db2xvci5QYWxldHRlKClcbiAgICBncmFwaCA9IG5ldyBSaWNrc2hhdy5HcmFwaFxuICAgICAgZWxlbWVudDogJGVsXG4gICAgICB3aWR0aDogMTAwXG4gICAgICBoZWlnaHQ6IDUwXG4gICAgICByZW5kZXJlcjogJ2xpbmUnXG4gICAgICBzZXJpZXM6IFtcbiAgICAgICAgZGF0YTogXy5tYXAoZGF0YSwgKGRhdHVtLCBpKSAtPlxuICAgICAgICAgIHg6IGlcbiAgICAgICAgICB5OiBkYXR1bS5jb3VudFxuICAgICAgICApXG4gICAgICAgIGNvbG9yOiBwYWxldHRlLmNvbG9yKClcbiAgICAgIF1cblxuICAgIGdyYXBoLnJlbmRlcigpXG5cbiAgbSAnZGl2LnNwYXJrbGluZScsIHtjb25maWc6IHNwYXJrbGluZX1cblxuIyBEZXRlcm1pbmUgaWYgdHdvIHZhbHVlcyBhcmUgc3RhdGlzdGljYWxseSBkaWZmZXJlbnRcbiMgcmV0dXJucyB0aGUgcC12YWx1ZVxuI1xuIyBodHRwOi8vd3d3LmlhbmNhbXBiZWxsLmNvLnVrL3R3b2J5dHdvL24tMV90aGVvcnkuaHRtXG4jIEIgaXMgc3VjY2Vzc2Z1bCBjb252ZXJpb25zXG4jIG5vdC1CIGlzIHVuc3VjY2Vzc2Z1bCBjb252ZXJzaW9uc1xuIyBBIGlzIHRlc3QgMVxuIyBub3QtQSBpcyB0ZXN0IDJcbiNcbiMgZm9ybXVsYVxuIyAoYSpkIC0gYipjKSoqMiAqIChOIC0xKSAvIChtKm4qcipzKVxuI1xuIyAgICAgICAgICBCICBub3QtQiAgVG90YWxcbiMgQSAgICAgfCAgYSAgICBiICAgICAgbVxuIyBub3QtQSB8ICBjICAgIGQgICAgICBuXG4jIFRvdGFsIHwgIHIgICAgcyAgICAgIE5cbiNcbm5NaW51c09uZUNoaVNxdWFyZSA9IChhQ29udmVyc2lvbnMsIGFUb3RhbCwgYkNvbnZlcnNpb25zLCBiVG90YWwpIC0+XG4gIGEgPSBhQ29udmVyc2lvbnNcbiAgYiA9IGFUb3RhbCAtIGFDb252ZXJzaW9uc1xuICBjID0gYkNvbnZlcnNpb25zXG4gIGQgPSBiVG90YWwgLSBiQ29udmVyc2lvbnNcblxuICByID0gYSArIGNcbiAgcyA9IGIgKyBkXG4gIG0gPSBhICsgYlxuICBuID0gYyArIGRcbiAgTiA9IG0gKyBuICsgciArIHNcblxuICBjaGkyID0gKGEqZCAtIGIqYykqKjIgKiAoTiAtIDEpIC8gKG0qbipyKnMpXG4gIHogPSBNYXRoLnNxcnQoTWF0aC5hYnMoY2hpMikpXG4gIDEgLSBwRnJvbVooeilcblxucEZyb21aID0gKHopIC0+XG4gIFpfTUFYID0gNi4wXG5cbiAgaWYgeiA9PSAwLjBcbiAgICB4ID0gMC4wXG4gIGVsc2VcbiAgICB5ID0gMC41ICogTWF0aC5hYnMoeilcbiAgICBpZiB5ID4gKFpfTUFYICogMC41KVxuICAgICAgeCA9IDEuMFxuICAgIGVsc2UgaWYgeSA8IDEuMFxuICAgICAgdyA9IHkgKiB5XG4gICAgICB4ID0gKCgoKCgoKCgwLjAwMDEyNDgxODk4NyAqIHcgLVxuICAgICAgICAgICAgICAgICAgMC4wMDEwNzUyMDQwNDcpICogdyArIDAuMDA1MTk4Nzc1MDE5KSAqIHcgLVxuICAgICAgICAgICAgICAgICAgMC4wMTkxOTgyOTIwMDQpICogdyArIDAuMDU5MDU0MDM1NjQyKSAqIHcgLVxuICAgICAgICAgICAgICAgICAgMC4xNTE5Njg3NTEzNjQpICogdyArIDAuMzE5MTUyOTMyNjk0KSAqIHcgLVxuICAgICAgICAgICAgICAgICAgMC41MzE5MjMwMDczMDApICogdyArIDAuNzk3ODg0NTYwNTkzKSAqIHkgKiAyLjBcbiAgICBlbHNlXG4gICAgICB5IC09IDIuMFxuICAgICAgeCA9ICgoKCgoKCgoKCgoKCgtMC4wMDAwNDUyNTU2NTkgKiB5ICtcbiAgICAgICAgICAgICAgICAgICAgICAgIDAuMDAwMTUyNTI5MjkwKSAqIHkgLSAwLjAwMDAxOTUzODEzMikgKiB5IC1cbiAgICAgICAgICAgICAgICAgICAgICAgIDAuMDAwNjc2OTA0OTg2KSAqIHkgKyAwLjAwMTM5MDYwNDI4NCkgKiB5IC1cbiAgICAgICAgICAgICAgICAgICAgICAgIDAuMDAwNzk0NjIwODIwKSAqIHkgLSAwLjAwMjAzNDI1NDg3NCkgKiB5ICtcbiAgICAgICAgICAgICAgICAgICAgICAgIDAuMDA2NTQ5NzkxMjE0KSAqIHkgLSAwLjAxMDU1NzYyNTAwNikgKiB5ICtcbiAgICAgICAgICAgICAgICAgICAgICAgIDAuMDExNjMwNDQ3MzE5KSAqIHkgLSAwLjAwOTI3OTQ1MzM0MSkgKiB5ICtcbiAgICAgICAgICAgICAgICAgICAgICAgIDAuMDA1MzUzNTc5MTA4KSAqIHkgLSAwLjAwMjE0MTI2ODc0MSkgKiB5ICtcbiAgICAgICAgICAgICAgICAgICAgICAgIDAuMDAwNTM1MzEwODQ5KSAqIHkgKyAwLjk5OTkzNjY1NzUyNFxuICBpZiB6ID4gMC4wIHRoZW4gKCh4ICsgMS4wKSAqIDAuNSkgZWxzZSAoKDEuMCAtIHgpICogMC41KVxuXG5pc1BTaWduaWZpY2FudCA9IChwKSAtPlxuICBwID4gMC4wNVxuXG5SZXN1bHRTdG9yZSA9IGRvIC0+XG4gIHRyYW5zZm9ybSA9IChkYXRhKSAtPlxuXG4gICAgIyBjb3VudCB0b3RhbCBjb252ZXJzaW9uc1xuICAgIGRhdGEgPSBkYXRhLm1hcCAocmVzdWx0KSAtPlxuICAgICAgcmVzdWx0LnRvdGFsQ29udmVyc2lvbnMgPSBfLnJlZHVjZShyZXN1bHQuZGF0YSwgKHN1bSwgZGF0dW0pIC0+XG4gICAgICAgIHN1bSArIGRhdHVtLmNvdW50XG4gICAgICAsIDApXG4gICAgICByZXR1cm4gcmVzdWx0XG5cbiAgICAjIGNhbGN1bGF0ZSBwLXZhbHVlIGFuZCBwZXJjZW50YWdlIGNoYW5nZSBhZ2FpbnN0IHRoZSBmaXJzdCByZXN1bHRcbiAgICBjb250cm9sID0gZGF0YVswXVxuICAgIGNvbnRyb2wucCA9IDBcbiAgICBjb250cm9sLnBlcmNlbnREZWx0YSA9IDBcblxuICAgIGRhdGEgPSBkYXRhLnNsaWNlKDEpLm1hcCAocmVzdWx0KSAtPlxuICAgICAgYUNvbnZlcnNpb25zID0gcmVzdWx0LnRvdGFsQ29udmVyc2lvbnNcbiAgICAgIGFUb3RhbCA9IHJlc3VsdC5wYXJ0aWNpcGFudENvdW50XG4gICAgICBiQ29udmVyc2lvbnMgPSBjb250cm9sLnRvdGFsQ29udmVyc2lvbnNcbiAgICAgIGJUb3RhbCA9IGNvbnRyb2wucGFydGljaXBhbnRDb3VudFxuXG4gICAgICBhUGVyY2VudCA9IGFDb252ZXJzaW9ucyAvIGFUb3RhbFxuICAgICAgYlBlcmNlbnQgPSBiQ29udmVyc2lvbnMgLyBiVG90YWxcbiAgICAgIHBlcmNlbnREZWx0YSA9IGFQZXJjZW50IC0gYlBlcmNlbnRcblxuICAgICAgcCA9IG5NaW51c09uZUNoaVNxdWFyZShcbiAgICAgICAgYUNvbnZlcnNpb25zLFxuICAgICAgICBhVG90YWwsXG4gICAgICAgIGJDb252ZXJzaW9ucyxcbiAgICAgICAgYlRvdGFsKVxuXG4gICAgICByZXN1bHQucCA9IHBcbiAgICAgIHJlc3VsdC5wZXJjZW50RGVsdGEgPSBwZXJjZW50RGVsdGFcblxuICAgICAgcmV0dXJuIHJlc3VsdFxuXG4gICAgZGF0YSA9IFtjb250cm9sXS5jb25jYXQgXy5zb3J0QnkoZGF0YSwgJ3BlcmNlbnREZWx0YScpLnJldmVyc2UoKVxuICAgIHJldHVybiBkYXRhXG5cbiAgZGF0YSA9IG0ucmVxdWVzdFxuICAgIG1ldGhvZDogJ0dFVCdcbiAgICB1cmw6ICcnJy9hcGkvZmFrZS9leHBlcmltZW50cy9zaWdudXBUZXh0L3Jlc3VsdHM/XG4gICAgICAgICBmcm9tPTEvMS8xNCZ0bz0xLzMwLzE0JnNwbGl0PVBsYXRmb3JtLEJyb3dzZXImY29udmVyc2lvbj1zaWduVXAnJydcblxuICBnZXRBbGw6IC0+XG4gICAgZGF0YS50aGVuKHRyYW5zZm9ybSlcbiAgcXVlcnk6IChxKSAtPlxuICAgIHEgPSBfLmRlZmF1bHRzIHEsXG4gICAgICAgZXhwZXJpbWVudDogJydcbiAgICAgICBzdGFydDogJydcbiAgICAgICBlbmQ6ICcnXG4gICAgICAgc3BsaXRzOiAnJ1xuICAgICAgIGNvbnZlcnNpb246ICcnXG4gICAgICAgbmFtZXNwYWNlOiAnJ1xuXG4gICAgbS5yZXF1ZXN0XG4gICAgICBtZXRob2Q6ICdHRVQnXG4gICAgICB1cmw6IFwiXCJcIi9hcGkvI3txLm5hbWVzcGFjZX0vZXhwZXJpbWVudHMvI3txLmV4cGVyaW1lbnR9L3Jlc3VsdHNcbiAgICAgID9mcm9tPSN7bW9tZW50KHEuc3RhcnQpLmZvcm1hdCgnTCcpfVxuICAgICAgJnRvPSN7bW9tZW50KHEuZW5kKS5mb3JtYXQoJ0wnKX1cbiAgICAgICZzcGxpdD0je3Euc3BsaXRzfVxuICAgICAgJmNvbnZlcnNpb249I3txLmNvbnZlcnNpb259XCJcIlwiXG4gICAgLnRoZW4odHJhbnNmb3JtKS50aGVuKGRhdGEpXG5cblF1ZXJ5QnVpbGRlciA9IChxdWVyeUhhbmRsZXIpIC0+XG4gIGV4cGVyaW1lbnQgPSBtLnByb3AgJ3NpZ251cFRleHQnXG4gIHN0YXJ0ID0gbS5wcm9wIG1vbWVudCgpLnN1YnRyYWN0KCdkYXlzJywgMTQpLmZvcm1hdCgnTCcpLnRvU3RyaW5nKClcbiAgZW5kID0gbS5wcm9wIG1vbWVudCgpLmZvcm1hdCgnTCcpLnRvU3RyaW5nKClcbiAgc3BsaXRzID0gbS5wcm9wICcnXG4gIGNvbnZlcnNpb24gPSBtLnByb3AgJ3NpZ25VcCdcbiAgbmFtZXNwYWNlID0gbS5wcm9wICcnXG5cbiAgcXVlcnkgPSAtPlxuICAgIHF1ZXJ5SGFuZGxlclxuICAgICAgZXhwZXJpbWVudDogZXhwZXJpbWVudCgpXG4gICAgICBzdGFydDogc3RhcnQoKVxuICAgICAgZW5kOiBlbmQoKVxuICAgICAgc3BsaXRzOiBzcGxpdHMoKSxcbiAgICAgIGNvbnZlcnNpb246IGNvbnZlcnNpb24oKVxuICAgICAgbmFtZXNwYWNlOiBuYW1lc3BhY2UoKVxuICAtPlxuICAgIG0gJ2RpdicsIFtcbiAgICAgIG0gJ2lucHV0JyxcbiAgICAgICAgdmFsdWU6IG5hbWVzcGFjZSgpXG4gICAgICAgIHBsYWNlaG9sZGVyOiAnbmFtZXNwYWNlJ1xuICAgICAgICBvbmNoYW5nZTogbS53aXRoQXR0cigndmFsdWUnLCBuYW1lc3BhY2UpXG4gICAgICBtICdpbnB1dCcsXG4gICAgICAgIHZhbHVlOiBleHBlcmltZW50KClcbiAgICAgICAgcGxhY2Vob2xkZXI6ICdleHBlcmltZW50J1xuICAgICAgICBvbmNoYW5nZTogbS53aXRoQXR0cigndmFsdWUnLCBleHBlcmltZW50KVxuICAgICAgbSAnaW5wdXQnLFxuICAgICAgICB2YWx1ZTogc3RhcnQoKVxuICAgICAgICBwbGFjZWhvbGRlcjogJ3N0YXJ0J1xuICAgICAgICBvbmNoYW5nZTogbS53aXRoQXR0cigndmFsdWUnLCBzdGFydClcbiAgICAgIG0gJ2lucHV0JyxcbiAgICAgICAgdmFsdWU6IGVuZCgpXG4gICAgICAgIHBsYWNlaG9sZGVyOiAnZW5kJ1xuICAgICAgICBvbmNoYW5nZTogbS53aXRoQXR0cigndmFsdWUnLCBlbmQpXG4gICAgICBtICdpbnB1dCcsXG4gICAgICAgIHZhbHVlOiBzcGxpdHMoKVxuICAgICAgICBwbGFjZWhvbGRlcjogJ3NwbGl0cyAoLCBzZXBhcmF0ZWQpJ1xuICAgICAgICBvbmNoYW5nZTogbS53aXRoQXR0cigndmFsdWUnLCBzcGxpdHMpXG4gICAgICBtICdpbnB1dCcsXG4gICAgICAgIHZhbHVlOiBjb252ZXJzaW9uKClcbiAgICAgICAgcGxhY2Vob2xkZXI6ICdjb252ZXJzaW9uJ1xuICAgICAgICBvbmNoYW5nZTogbS53aXRoQXR0cigndmFsdWUnLCBjb252ZXJzaW9uKVxuICAgICAgbSAnYnV0dG9uJyxcbiAgICAgICAgb25jbGljazogcXVlcnksXG4gICAgICAgICdnbydcbiAgICBdXG5cbkV4cGVyaW1lbnRTdG9yZSA9IGRvIC0+XG4gIGRhdGEgPSBtLnJlcXVlc3RcbiAgICBtZXRob2Q6ICdHRVQnXG4gICAgdXJsOiAnL2FwaS9mYWtlL2V4cGVyaW1lbnRzJ1xuXG4gIGdldEFsbDogLT5cbiAgICBkYXRhXG5cbkNvbnZlcnNpb25TdG9yZSA9IGRvIC0+XG4gIGRhdGEgPSBtLnJlcXVlc3RcbiAgICBtZXRob2Q6ICdHRVQnXG4gICAgdXJsOiAnL2FwaS9mYWtlL2NvbnZlcnNpb25zL3VuaXEnXG5cbiAgZ2V0QWxsOiAtPlxuICAgIGRhdGFcblxuRXhwZXJpbWVudFN0YXRlID0gKGV4cGVyaW1lbnRzKSAtPlxuICBtICd1bCcsIGV4cGVyaW1lbnRzLm1hcCAoZXhwZXJpbWVudCkgLT5cbiAgICBtICdsaScsIFtcbiAgICAgIGV4cGVyaW1lbnQubmFtZSxcbiAgICAgIG0gJ3VsJyxcbiAgICAgICAgZXhwZXJpbWVudC52YWx1ZXMubWFwICh2YWwpIC0+XG4gICAgICAgICAgbSAnbGknLCB2YWxcbiAgICBdXG5cbkNvbnZlcnNpb25TdGF0ZSA9IChjb252ZXJzaW9ucykgLT5cbiAgbSAndWwnLCBjb252ZXJzaW9ucy5tYXAgKGNvbnZlcnNpb24pIC0+XG4gICAgbSAnbGknLCBjb252ZXJzaW9uLm5hbWVcblxuU2hvd1N0YXRlID0gKGV4cGVyaW1lbnRzLCBjb252ZXJzaW9ucykgLT5cbiAgW1xuICAgICdFeHBlcmltZW50cycsXG4gICAgRXhwZXJpbWVudFN0YXRlKGV4cGVyaW1lbnRzKSxcbiAgICAnQ29udmVyc2lvbnMnLFxuICAgIENvbnZlcnNpb25TdGF0ZShjb252ZXJzaW9ucylcbiAgXVxuXG5SZWNvaWxDb250cm9sbGVyID0gLT5cbiAgcmVzdWx0czogUmVzdWx0U3RvcmUuZ2V0QWxsKClcbiAgZXhwZXJpbWVudHM6IEV4cGVyaW1lbnRTdG9yZS5nZXRBbGwoKVxuICBjb252ZXJzaW9uczogQ29udmVyc2lvblN0b3JlLmdldEFsbCgpXG5cblF1ZXJ5VmlldyA9IFF1ZXJ5QnVpbGRlcihSZXN1bHRTdG9yZS5xdWVyeSlcblxuUmVjb2lsVmlldyA9IChjdHJsKSAtPlxuICB0aXRsZXMgPSBbJ3Rlc3QnLCAnc3BhcmtsaW5lJ11cbiAgICAuY29uY2F0KGlmIGN0cmwucmVzdWx0cygpWzBdIHRoZW4gXy5rZXlzKGN0cmwucmVzdWx0cygpWzBdLnNwbGl0cykpXG4gICAgLmNvbmNhdChbJ2NvbnZlcnNpb25zJywgJ3BhcnRpY2lwYW50cycsXG4gICAgICAgICAgICAgJ3BlcmNlbnQnLCAncCA8IDAuMDUnLCAnZGVsdGEnXSlcblxuICBwZXJjZW50ID0gKG4pIC0+XG4gICAgKG4gKiAxMDApLnRvRml4ZWQoMikgKyAnJSdcblxuICByZXR1cm4gW1xuICAgIFNob3dTdGF0ZShjdHJsLmV4cGVyaW1lbnRzKCksIGN0cmwuY29udmVyc2lvbnMoKSlcbiAgICBtICdicidcbiAgICBRdWVyeVZpZXcoKVxuICAgIG0gJ2JyJ1xuICAgIG0oJ3RhYmxlJywgdGl0bGVzLm1hcChtLmJpbmQobSwgJ3RoJykpXG4gICAgLmNvbmNhdChfLm1hcChfLnZhbHVlcyhjdHJsLnJlc3VsdHMoKSksIChyZXN1bHQpIC0+XG4gICAgICBjb2xvciA9IGlmIHJlc3VsdC5wZXJjZW50RGVsdGEgPiAwIHRoZW4gJ2dyZWVuJyBlbHNlXG4gICAgICAgICAgICAgIGlmIHJlc3VsdC5wZXJjZW50RGVsdGEgPT0gMCB0aGVuICdibGFjaycgZWxzZSAncmVkJ1xuXG4gICAgICByZXR1cm4gbSgndHInLCBbXG4gICAgICAgIG0oJ3RkJywgcmVzdWx0LnRlc3QpLFxuICAgICAgICBtKCd0ZCcsIFtTcGFya0xpbmUocmVzdWx0LmRhdGEpXSlcbiAgICAgIF1cbiAgICAgIC5jb25jYXQoXy5tYXAoXy52YWx1ZXMocmVzdWx0LnNwbGl0cyksIG0uYmluZChtLCAndGQnKSApKVxuICAgICAgLmNvbmNhdChbXG4gICAgICAgIG0gJ3RkJywgcmVzdWx0LnRvdGFsQ29udmVyc2lvbnNcbiAgICAgICAgbSAndGQnLCByZXN1bHQucGFydGljaXBhbnRDb3VudFxuICAgICAgICBtICd0ZCcsIHBlcmNlbnQgcmVzdWx0LnRvdGFsQ29udmVyc2lvbnMgLyByZXN1bHQucGFydGljaXBhbnRDb3VudFxuICAgICAgICBtICd0ZCcsIHJlc3VsdC5wLnRvRml4ZWQoMylcbiAgICAgICAgbSAndGQnLCBzdHlsZTogY29sb3I6IGNvbG9yLCBwZXJjZW50IHJlc3VsdC5wZXJjZW50RGVsdGFcbiAgICAgIF0pKVxuICAgICkpKVxuICBdXG5cbm0ubW9kdWxlIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZWNvaWwnKSxcbiAgICAgICAge2NvbnRyb2xsZXI6IFJlY29pbENvbnRyb2xsZXIsIHZpZXc6IFJlY29pbFZpZXd9XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=